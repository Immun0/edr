---
title: "Chapter 3.1"
author: "rwr"
output: html_document
---

```{r load_tidyverse_rwr}
library(tidyverse)
library(rwr)
```


## Making Simple ggplot Scatterplots

### Figure 3.1 Our first ggplot plot is… empty.

```{r gg_empty}
ggplot(data = dmd, mapping = aes(x = carats, y = price))
```

### Figure 3.2 Our first ggplot plot… with data!

```{r dmd_carats_price}
ggplot(data = dmd, mapping = aes(x = carats, y = price)) +
  geom_point()
```

### Figure 3.3. Experimenting with different variables for x and y results in a different plot. It’s not very informative but that’s okay, we are learning.

```{r dmd_carats_depth}
ggplot(data = dmd, mapping = aes(x = carats, y = depth)) +
  geom_point()
```

### Figure 3.4. Mapping an aesthetic other than x and y can show us how groupings of data interrelate.

```{r dmd_shape_for_clarity}
ggplot(dmd, mapping = aes(x = carats, y = price, shape = clarity)) +
  geom_point()
```

### Figure 3.5. The use of transparency (or, alpha) can alleviate the problems associated with a high degree of overplotting.

```{r dmd_carats_price_alpha}
ggplot(dmd, mapping = aes(x = carats, y = price, shape = clarity)) +
  geom_point(alpha = 0.25)
```

### Figure 3.6. Setting all points to a specific color is possible and sometimes desirable.

```{r dmd_all_gray50_points}
ggplot(dmd, mapping = aes(x = carats, y = price)) +
  geom_point(color = "gray50")
```


```{r plot_a_bw_variation}
cols <- c("Fair" = "gray75", "Great" = "gray50", "The Best" = "gray5")

ggplot(dmd, aes(x = carats, y = price)) +
  geom_point(mapping = aes(color = cut, shape = clarity)) +
  scale_colour_manual(values = cols)
```

### Figure 3.7a Example using different combinations of aesthetics (plot_a).

```{r plot_a}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point(mapping = aes(color = cut, shape = clarity))
```

### Figure 3.7b Example using different combinations of aesthetics (plot_b).

```{r plot_b}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point(mapping = aes(size = depth), alpha = 0.05)
```

### Figure 3.7c Example using different combinations of aesthetics (plot_c).

```{r plot_c}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point(color = "gray50", fill = "#AAAFEF", shape = 23)
```

### Figure 3.7d Example using different combinations of aesthetics (plot_d).

```{r plot_d}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point(mapping = aes(color = depth, shape = clarity))
```


### Figure 3.8. Faceting by a single categorical variable.

```{r dmd_facet_clarity}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point() +
  facet_wrap(facets = vars(clarity))
```

### Figure 3.9. Faceting by two categorical variables with facet_wrap().

```{r dmd_facet_cut_clarity}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point() +
  facet_wrap(facets = vars(cut, clarity))
```

### Figure 3.10. Faceting by two categorical variables and making clearer which variables the labels belong to (by way of labeller = label_both).

```{r dmd_facet_cut_clarity_labeller}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point() +
  facet_wrap(facets = vars(cut, clarity), labeller = label_both)
```

### Figure 3.11. We can influence the layout of panels by setting a value for nrow (we can optionally set a value for ncol as well).

```{r dmd_facet_cut_clarity_wide}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point() +
  facet_wrap(facets = vars(cut, clarity), nrow = 1, labeller = label_both)
```

### Figure 3.12. Faceting by two categorical variables with facet_grid().

```{r dmd_facet_cut_clarity_grid}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point(alpha = 0.2) +
  facet_grid(rows = vars(cut), cols = vars(clarity), labeller = label_both)
```


### Figure 3.13. Replacement of default labels in the plot axis and legend titles with labs().

```{r plot_a_new_labs}
ggplot(dmd, mapping = aes(x = carats, y = price)) +
  geom_point(mapping = aes(shape = clarity)) +
  labs(
    x = "Weight of the Diamond (carats)",
    y = "Price (USD)",
    shape = "Diamond Clarity"
  )
```

### Figure 3.14. Replacement of default labels and the addition of a title, subtitle, and a caption. All with labs().

```{r plot_a_labs_titles}
ggplot(dmd, mapping = aes(x = carats, y = price)) +
  geom_point(mapping = aes(shape = clarity)) +
  labs(
    title = "The Relationship Between Diamond Weight on Price",
    subtitle = "Quality of diamond clarity is indicated by shape",
    caption = "Data taken from the `dmd` dataset",
    x = "Weight of the Diamond (carats)", y = "Price (USD)",
    color = "Diamond Cut", shape = "Diamond Clarity"
  )
```

### Figure 3.15g Example using different placements of the legend (plot_e).

```{r plot_e}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point(aes(shape = clarity)) +
  labs(shape = "Clarity") +
  theme(legend.position = "right")
```

### Figure 3.15f Example using different placements of the legend (plot_f).

```{r plot_f}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point(aes(shape = clarity)) +
  labs(shape = "Clarity") +
  theme(legend.position = "bottom")
```

### Figure 3.15g Example using different placements of the legend (plot_g).

```{r plot_g}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point(aes(shape = clarity)) +
  labs(shape = "Clarity") +
  theme(legend.justification = "top")
```

### Figure 3.15h Example using different placements of the legend (plot_h).

```{r plot_h}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point(aes(shape = clarity)) +
  labs(shape = "Clarity") +
  theme(legend.position = "none")
```

### Figure 3.16. Modifying data with dplyr; plotting it with ggplot.

```{r dmd_modified_dplyr}
dmd_mod <- 
  dmd %>%
  mutate(cpc = price / carats) %>%
  mutate(price_class = ifelse(
    cpc >= 3460, "Above Median", "Below Median")
  ) %>%
  mutate(quality = ifelse(
    cut == "The Best" & clarity == "The Best",
    "Top Drawer", "The Rest")
  )

ggplot(dmd_mod, aes(x = carats, y = price)) +
  geom_point() +
  facet_wrap(
    facets = vars(price_class, quality),
    labeller = label_both
  ) +
  labs(x = "Carats", y = "Price")
```
