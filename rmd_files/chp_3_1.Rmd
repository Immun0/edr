---
title: "Chapter 3.1"
author: "rwr"
output: 
  html_document:
    df_print: paged
---

```{r load_tidyverse}
library(tidyverse)
library(rwr)
```


## Making Simple ggplot Scatterplots

```{r gg_empty}
ggplot(data = dmd, mapping = aes(x = carats, y = price))
```


```{r dmd_carats_price}
ggplot(data = dmd, mapping = aes(x = carats, y = price)) +
  geom_point()
```


```{r dmd_carats_depth}
ggplot(data = dmd, mapping = aes(x = carats, y = depth)) +
  geom_point()
```

```{r clarity_as_color_scale}
ggplot(dmd, mapping = aes(x = carats, y = price, color = clarity)) +
  geom_point()
```


```{r dmd_carats_price_alpha}
ggplot(dmd, mapping = aes(x = carats, y = price, color = clarity)) +
  geom_point(alpha = 0.2)
```


```{r transparent_blue_points}
ggplot(dmd, mapping = aes(x = carats, y = price)) +
  geom_point(alpha = 0.2, color = "blue")
```


```{r plot_1}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point(mapping = aes(color = cut, shape = clarity))
```

```{r plot_2}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point(mapping = aes(size = depth), alpha = 0.05)
```

```{r plot_3}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point(color = "purple", fill = "#AAAFEF", shape = 23)
```

```{r plot_4}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point(mapping = aes(color = depth, shape = clarity))
```


## Facets and the act of faceting in ggplot

```{r dmd_facet_cut}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point() +
  facet_wrap(facets = vars(cut))
```


```{r dmd_facet_cut_clarity}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point() +
  facet_wrap(facets = vars(cut, clarity))
```


```{r dmd_facet_cut_clarity_labeller}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point() +
  facet_wrap(facets = vars(cut, clarity), labeller = label_both)
```


```{r dmd_facet_cut_clarity_wide}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point() +
  facet_wrap(facets = vars(cut, clarity), nrow = 1, labeller = label_both)
```


```{r dmd_facet_cut_clarity_grid}
ggplot(dmd, aes(x = carats, y = price)) +
  geom_point(alpha = 0.2) +
  facet_grid(rows = vars(cut), cols = vars(clarity), labeller = label_both)
```


## Working with labels and titles

```{r plot_1_new_labs}
ggplot(dmd, mapping = aes(x = carats, y = price)) +
  geom_point(mapping = aes(color = cut, shape = clarity)) +
  labs(
    x = "Weight of the Diamond (carats)", y = "Price (USD)",
    color = "Diamond Cut", shape = "Diamond Clarity"
  )
```


```{r plot_1_labs_titles}
ggplot(dmd, mapping = aes(x = carats, y = price)) +
  geom_point(mapping = aes(color = cut, shape = clarity)) +
  labs(
    title = "The Relationship Between Diamond Weight on Price",
    subtitle = "Quality of diamond cut and clarity indicated by color and shape",
    caption = "Data taken from the `dmd` dataset",
    x = "Weight of the Diamond (carats)", y = "Price (USD)",
    color = "Diamond Cut", shape = "Diamond Clarity"
  )
```


## Modifying the location of legends

```{r plot_legend_right}
ggplot(dmd, mapping = aes(x = carats, y = price)) +
  geom_point(mapping = aes(color = cut, shape = clarity)) +
  labs(color = "Diamond Cut", shape = "Diamond Clarity") +
  theme(legend.position = "right")
```

```{r plot_legend_bottom}
ggplot(dmd, mapping = aes(x = carats, y = price)) +
  geom_point(mapping = aes(color = cut, shape = clarity)) +
  labs(color = "Diamond Cut", shape = "Diamond Clarity") +
  theme(legend.position = "bottom")
```

```{r plot_legend_just_top}
ggplot(dmd, mapping = aes(x = carats, y = price)) +
  geom_point(mapping = aes(color = cut, shape = clarity)) +
  labs(color = "Diamond Cut", shape = "Diamond Clarity") +
  theme(legend.justification = "top")
```

```{r plot_legend_none}
ggplot(dmd, mapping = aes(x = carats, y = price)) +
  geom_point(mapping = aes(color = cut, shape = clarity)) +
  labs(color = "Diamond Cut", shape = "Diamond Clarity") +
  theme(legend.position = "none")
```


## Modifying your dataset, plotting, and modifying again.


```{r dmd_modified_dplyr}
dmd_mod <- 
  dmd %>%
  mutate(cpc = price / carats) %>%
  mutate(top_drawer = ifelse(
    cut == "The Best" & clarity == "The Best",
    "The Ultimate", "The Rest")) %>%
  mutate(price_class = ifelse(
    cpc >= 3460, "Above Median Price", "Below Median Price")
  )

ggplot(dmd_mod, aes(x = carats, y = price)) +
  geom_point(aes(color = top_drawer, shape = price_class)) +
  facet_wrap(facets = vars(price_class, top_drawer)) +
  labs(color = "Overall Quality", shape = "Price") +
  theme(strip.text.x = element_blank())
```



